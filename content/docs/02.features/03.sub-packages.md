---
title: 分包配置
description: 了解如何使用分包功能优化应用加载性能。
---

## 什么是分包？

分包是 UniApp 提供的一种优化机制，可以将小程序/App 拆分成多个包

## 配置分包目录

在 `vite.config.ts` 中配置分包目录：

### 单个分包

```ts [vite.config.ts]
import uni from '@dcloudio/vite-plugin-uni'
import UniPages from 'uni-pages'
import { defineConfig } from 'vite'

export default defineConfig({
  plugins: [
    UniPages({
      subPackageDirs: ['pages-sub'],  // 分包目录
    }),
    uni(),
  ],
})
```

### 多个分包

```ts
UniPages({
  subPackageDirs: [
    'pages-sub',      // 通用分包
    'pages-user',     // 用户模块分包
    'pages-order',    // 订单模块分包
  ],
})
```

## 分包插件

在 `pages.config.ts` 中可以为分包配置插件：

```ts [src/pages.config.ts]
import { defineConfig } from 'uni-pages'

export default defineConfig({
  subPackages: [
    {
      root: 'pages-sub',
      pages: [],  // 由 uni-pages 自动填充
      plugins: {
        'uni-id-pages': {
          version: '1.0.0',
          provider: 'https://your-cloud-function.com',
        },
      },
    },
  ],
})
```


## 完整实例

### 目录结构

根据配置分包目录

```
src/
├── pages/                 # 主包页面
│   ├── index/
│   │   └── index.vue
│   └── user/
│       └── index.vue
├── pages-sub/             # 分包：pages-sub
│   ├── detail/
│   │   └── index.vue
│   └── list/
│       └── index.vue
├── pages-user/            # 分包：pages-user
│   ├── profile/
│   │   └── index.vue
│   └── settings/
│       └── index.vue
└── pages.config.ts
```

### 生成的 pages.json

uni-pages 会自动生成分包配置：

```json
{
  "pages": [
    { "path": "pages/index/index" },
    { "path": "pages/user/index" }
  ],
  "subPackages": [
    {
      "root": "pages-sub",
      "pages": [
        { "path": "detail/index" },
        { "path": "list/index" }
      ]
    },
    {
      "root": "pages-user",
      "pages": [
        { "path": "profile/index" },
        { "path": "settings/index" }
      ]
    }
  ]
}
```
